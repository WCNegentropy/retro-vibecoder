tests/
├── __fixtures__/                       # Reusable test data
│   ├── manifests/
│   │   ├── valid/
│   │   │   ├── simple.upg.yaml         # Single string prompt
│   │   │   ├── conditional.upg.yaml    # when clause + dependencies
│   │   │   ├── complex.upg.yaml        # Multiple types, nested logic
│   │   │   └── generated-schema/       # Expected JSON Schema output
│   │   │       ├── simple.schema.json
│   │   │       ├── conditional.schema.json
│   │   │       └── complex.schema.json
│   │   └── invalid/
│   │       ├── missing-required-fields.yaml
│   │       ├── invalid-type.yaml
│   │       ├── circular-dependency.yaml
│   │       └── malformed-jinja2.yaml
│   ├── projects/                      # Pre-generated projects for update testing
│   │   ├── react-v1.0.0/              # Generated with react-starter@1.0.0
│   │   │   ├── .upg-answers.yaml       # Stored answers
│   │   │   ├── package.json
│   │   │   ├── src/
│   │   │   └── [project files]
│   │   ├── react-v1.0.0-modified/     # User made modifications
│   │   │   ├── .upg-answers.yaml
│   │   │   ├── package.json            # Modified: added "prettier"
│   │   │   ├── src/
│   │   │   │   └── CustomComponent.tsx # Added by user
│   │   │   └── [modified files]
│   │   └── react-v2.0.0-target/       # What v2.0.0 would generate
│   │       ├── package.json
│   │       ├── src/
│   │       └── [new structure]
│   └── merge-scenarios/               # 3-way merge test data
│       ├── scenario-1-no-conflict/
│       │   ├── base.json
│       │   ├── current.json            # User modified this
│       │   ├── target.json             # New version has this
│       │   └── expected-result.json    # Expected 3-way merge output
│       ├── scenario-2-conflict/
│       │   └── [similar structure]     # Both sides modified same file
│       └── scenario-3-file-move/
│           └── [both sides reorganized]
│
├── unit/
│   ├── schema/
│   │   ├── validator.test.ts
│   │   │   ├── validates well-formed manifest ✓
│   │   │   ├── rejects manifest missing apiVersion ✓
│   │   │   ├── rejects invalid prompt type ✓
│   │   │   ├── validates conditional dependencies ✓
│   │   │   └── provides clear error messages ✓
│   │   └── __snapshots__/
│   │       └── validator.test.ts.snap  # Jest snapshots for error output
│   │
│   ├── transpiler/
│   │   ├── manifest-to-schema.test.ts
│   │   │   ├── simple string prompt transpiles correctly ✓
│   │   │   ├── select prompt generates enum ✓
│   │   │   ├── boolean prompt becomes checkbox schema ✓
│   │   │   ├── default values preserve dynamic expressions ✓
│   │   │   └── snapshot: complex manifest → schema ✓
│   │   ├── conditional-logic.test.ts
│   │   │   ├── when: "X == Y" maps to dependencies ✓
│   │   │   ├── when: "X != Y" negates correctly ✓
│   │   │   ├── multiple when clauses combine with AND ✓
│   │   │   ├── complex branching generates oneOf ✓
│   │   │   └── snapshot: branching logic output ✓
│   │   └── jinja2-filters.test.ts
│   │       ├── upper filter works ✓
│   │       ├── lower filter works ✓
│   │       ├── slug filter works ✓
│   │       ├── custom filters register ✓
│   │       └── unknown filter errors gracefully ✓
│   │
│   ├── cli/
│   │   ├── validate.test.ts
│   │   │   ├── validates well-formed manifest ✓
│   │   │   ├── reports specific error line numbers ✓
│   │   │   └── suggests fixes for common errors ✓
│   │   └── test-generate.test.ts
│   │       ├── generates project with fixture data ✓
│   │       ├── applies Jinja2 templates ✓
│   │       ├── skips conditional files ✓
│   │       └── reports generation errors ✓
│   │
│   └── shared/
│       ├── yaml-parser.test.ts
│       ├── schema-validator.test.ts
│       └── types.test.ts
│
├── integration/
│   ├── manifest-to-ui.test.ts          # YAML → JSON Schema → RJSF form
│   │   ├── single prompt renders correctly ✓
│   │   ├── multiple prompts render as fields ✓
│   │   ├── when clause hides/shows fields ✓
│   │   ├── validation errors display ✓
│   │   └── form submission validates data ✓
│   │
│   ├── generation-flow.test.ts         # Full flow: manifest → form → generation
│   │   ├── load manifest ✓
│   │   ├── render dynamic form ✓
│   │   ├── user submits answers ✓
│   │   ├── spawn Copier sidecar ✓
│   │   ├── capture generation logs ✓
│   │   └── verify output files exist ✓
│   │
│   ├── registry-search.test.ts
│   │   ├── clone registry repo ✓
│   │   ├── parse manifest metadata ✓
│   │   ├── search by name ✓
│   │   ├── search by tag ✓
│   │   └── filter by lifecycle ✓
│   │
│   ├── smart-update.test.ts            # 3-way merge scenarios
│   │   ├── no-conflict scenario passes through ✓
│   │   ├── user modification preserved ✓
│   │   ├── template patch applied ✓
│   │   ├── conflict generates markers ✓
│   │   ├── moved files detected ✓
│   │   └── new files added correctly ✓
│   │
│   └── sidecar-orchestration.test.ts   # Spawn + stream capture
│       ├── spawn Copier with args ✓
│       ├── capture stdout stream ✓
│       ├── capture stderr stream ✓
│       ├── handle sidecar timeout ✓
│       └── signal termination ✓
│
├── e2e/
│   ├── generation-flow.e2e.test.ts     # Real GUI + real Copier
│   │   ├── desktop app opens ✓
│   │   ├── user searches for template ✓
│   │   ├── user selects template ✓
│   │   ├── dynamic form renders ✓
│   │   ├── user fills form + clicks generate ✓
│   │   ├── sidecar runs in real-time ✓
│   │   ├── project generated at destination ✓
│   │   ├── .upg-answers.yaml written ✓
│   │   └── success screen displayed ✓
│   │
│   ├── update-flow.e2e.test.ts         # Real update scenario
│   │   ├── generate v1.0.0 project ✓
│   │   ├── user modifies files ✓
│   │   ├── run upg update ✓
│   │   ├── update detected (v2.0.0 available) ✓
│   │   ├── 3-way merge executed ✓
│   │   ├── user changes preserved ✓
│   │   ├── template patch applied ✓
│   │   └── conflicts shown if any ✓
│   │
│   ├── registry-flow.e2e.test.ts       # Registry search + template info
│   │   ├── marketplace opens ✓
│   │   ├── templates display ✓
│   │   ├── search filters results ✓
│   │   ├── template detail view opens ✓
│   │   ├── version history visible ✓
│   │   └── generate button starts flow ✓
│   │
│   └── fixtures/
│       ├── test-registry/              # Test Git registry repo
│       └── test-templates/             # Minimal test templates
│
└── template-validation/
    ├── schema.test.ts                  # Validate example templates against manifest schema
    │   ├── react-starter/upg.yaml is valid ✓
    │   ├── python-api/upg.yaml is valid ✓
    │   ├── monorepo-scaffold/upg.yaml is valid ✓
    │   └── all templates pass CI validation ✓
    │
    └── generation.test.ts              # Generate each example template
        ├── react-starter with defaults generates ✓
        ├── react-starter with options generates ✓
        ├── python-api with conditionals generates ✓
        ├── monorepo-scaffold complex scenario works ✓
        └── generated projects pass basic validation ✓
